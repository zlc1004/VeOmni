# Lumine Reasoning Config (Stage 3)
# Train on thought-image-action to learn hybrid thinking

model:
  model_path: output/lumine_stage2_instruct/hf_ckpt
  attn_implementation: flash_attn

data:
  train_path: ../lumine/data_reasoning.yaml
  chat_template: qwen2vl
  max_seq_len: 8192
  train_size: 100000
  datasets_type: mapping
  mm_configs:
    image_max_pixels: 262144
    video_max_pixels: 262144
    max_frames: 8
    fps: 2.0

train:
  output_dir: output/lumine_stage3_reasoning
  data_parallel_mode: fsdp2
  wandb_project: lumine
  wandb_name: lumine_stage3_reasoning
  rmpad: false
  rmpad_with_pos_ids: true
  ulysses_parallel_size: 1
  freeze_vit: true  # Freeze ViT in reasoning stage
  lr: 1.0e-5
  init_device: meta
  lr_decay_style: cosine
  num_train_epochs: 2
  micro_batch_size: 1
  global_batch_size: 4
  max_steps: 2000
  save_steps: 500
  save_epochs: 1
  save_hf_weights: true
